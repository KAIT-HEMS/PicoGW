<script type="text/javascript">
    RED.nodes.registerType('pico v2 conf',{
        category: 'advanced',
        color: '#ff8888',
        defaults: {
            path: {value:"temperature",required:true}
        },
        inputs:1,
        inputLabels:'Send reply or publish',
        outputs:2,
        outputLabels:['GET','PUT'],
        icon: "picon.v2.png",
        align: "left",
        label: function() {
            return '/v2/'+this.path||"pico v2 conf";
            //return this.name||"pico v2 conf";
        }
    });
</script>

<script type="text/x-red" data-template-name="pico v2 conf">
    <div class="form-row">
        <label for="node-input-path"><i class="icon-tag"></i> Path</label>
        <!-- input type="text" id="node-input-path" placeholder="Path" -->
        <select id="node-input-path" style="width:180px;">
            <option value="temperature">Temperature</option>
            <option value="brightness">Brightness</option>
        </select>
    </div>
</script>

<script type="text/x-red" data-help-name="pico v2 conf">
    <p>PicoGWのV2 APIを実装するためのノードです</p>
    <p>PicoGWのV2 APIは、V1 APIを使ってNode-REDで実装します。APIクライアントがPicoGWの/v2/から始まるパスにアクセスすると、このNode-REDのノードから当該リクエスト情報が出力されます。</p>
    <p>パスは今のところtemperatureとbrightnessしかありません。それぞれGETとPUTメソッドをサポートし、適宜更新値のpublishも行います。</p>
    <p>期待される動作</p>
    <p>temperature:</p>
    <p>・GET 現在値の取得。valueとして値（temperatureは絶対温度,brightnessはルクス)を浮動小数値で返す。argsとしてt=[unixtime]の指定により、過去のログまたは将来の予測値が得られる。location=[lat,lng,alt]の指定（メートル単位）により、他の位置の値も得られる。</p>
    <p>・PUT 現在の値を変更するリクエストを送る。valueとして期待する値を浮動小数値で与える。</p>
    <p>実装上の注意</p>
    <p>GET/PUTのときは、ノードから出力されるreqidという値を、そのまま同じパスのノード（自分自身でも可）への入力に含めなければならない。</p>
    <p>
        PicoGWはECHOENT Lite対応、神奈川工科大学発のホームサーバーです。
        関連情報は<a href="http://pico.peatix.com/">こちらから</a>。
    </p>
</script>
